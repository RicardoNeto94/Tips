<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Shang Shi — Tip Allocator (v5: Weekly CSV Converter)</title>
  <meta name="description" content="Upload WEEKLY cross‑tab CSV (Employee + date columns). App auto‑converts and allocates: Kitchen 25%, Staff 75% (equal or weighted).">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="wrap">
  <header class="topbar">
    <div class="brand">Shang&nbsp;Shi <span>Tip Allocator</span> <small class="small">v5</small></div>
    <div class="actions">
      <label class="file-btn">
        <input id="weeklyFile" type="file" accept=".csv,text/csv">
        <span>Upload Weekly CSV</span>
      </label>
      <label class="file-btn">
        <input id="weightsFile" type="file" accept=".csv,text/csv">
        <span>Upload Weights CSV (optional)</span>
      </label>
    </div>
  </header>

  <section class="hero">
    <h1>Weekly sheet → Normalized allocations</h1>
    <p>Drop your weekly export (left column <em>Employee</em>; then columns like <em>05/08, 06/08, ...</em> with <strong>Yes/No</strong>).</p>
    <ul class="tips">
      <li><strong>Kitchen</strong> is detected by the name “Kitchen”. If Kitchen=Yes on a day → Kitchen gets <strong>25%</strong> of that day’s pool.</li>
      <li>The remaining <strong>75%</strong> is split among present non‑kitchen staff — <em>equally</em> by default, or <em>weighted</em> if you upload a Weights CSV (same shape; numbers per person/day). Weight rule: <code>Value ÷ 4</code>.</li>
    </ul>
  </section>

  <section id="alerts" class="alerts"></section>

  <section class="pools">
    <h2>Daily Pools</h2>
    <div id="poolEditor" class="poolEditor"></div>
    <div class="row">
      <button id="recompute" class="btn">Recompute</button>
      <label class="chk"><input type="checkbox" id="useWeights"> Use weights (Value/4) if provided</label>
    </div>
  </section>

  <section class="stats" id="stats"></section>

  <section class="chart-block">
    <canvas id="chart" width="1200" height="360"></canvas>
  </section>

  <section class="table-wrap">
    <h2>Daily Allocation</h2>
    <table id="dailyTable">
      <thead id="thead-daily"></thead>
      <tbody id="tbody-daily"></tbody>
    </table>
  </section>

  <section class="table-wrap">
    <h2>Totals by Person</h2>
    <table id="totalTable">
      <thead id="thead-total"></thead>
      <tbody id="tbody-total"></tbody>
    </table>
  </section>

  <footer class="foot">
    <small>© Shang Shi — Static, client‑side. Nothing uploaded.</small>
  </footer>

<script src="app.js"></script>
</div>
</body>
</html>
